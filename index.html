<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Gran nube de confeti con texto</title>
  <link rel="stylesheet" href="./style.css"/>
</head>
<body>
  <div id="escena"></div>
  <canvas id="texto" width="800" height="200"></canvas>
  <input id="entrada" type="text" value="DESEAMOS QUE HAYAS DISFRUTADO ESTA EXPERIENCIA" />

  <script id="vs" type="x-shader/x-vertex">
    attribute vec2 anim;
    attribute vec3 desplazamiento;
    attribute vec3 control0;
    attribute vec3 control1;
    attribute vec4 giro;
    attribute vec3 colorF;
    attribute vec3 colorT;
    uniform float tiempo;
    varying vec3 vColorF;
    varying vec3 vColorT;

    vec3 rotar(vec4 q, vec3 v){
      return v + 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);
    }

    vec4 ejeAngulo(vec3 eje, float ang){
      float ha = ang * 0.5;
      return vec4(eje.xyz * sin(ha), cos(ha));
    }

    vec3 bezier(vec3 p0, vec3 p1, vec3 c0, vec3 c1, float t){
      float inv = 1.0 - t;
      return inv*inv*inv*p0 + 3.0*inv*inv*t*c0 + 3.0*inv*t*t*c1 + t*t*t*p1;
    }

    float ease(float t, float d){
      t = clamp(t/d, 0.0, 1.0) - 1.0;
      return -(t*t*t*t - 1.0);
    }

    void main(){
      float tt = clamp(tiempo - anim.x, 0.0, anim.y);
      float prog = ease(tt, anim.y);

      vec3 pos = position;
      vec4 q = ejeAngulo(giro.xyz, giro.w * prog);
      pos = rotar(q, pos);

      vec3 p0 = pos;
      vec3 p1 = pos + desplazamiento;
      pos = bezier(p0, p1, pos + control0, pos + control1, prog);

      vColorF = colorF;
      vColorT = colorT;

      gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
    }
  </script>

  <script id="fs" type="x-shader/x-fragment">
    varying vec3 vColorF;
    varying vec3 vColorT;
    void main(){
      gl_FragColor = gl_FrontFacing ? vec4(vColorF,1.0) : vec4(vColorT,1.0);
    }
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r71/three.min.js"></script>
  <script src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/175711/OrbitControls.js"></script>
  <script src="./script.js"></script>
</body>
</html>